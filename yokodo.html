<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Yokodo</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }

    #score-section {
      font-size: 60px;
      margin-top: 10px;
      text-align: center;
    }
    
    #quiz-lore {
      font-size: 30px;
      margin-top: 10px;
      text-align: center;
    }
    
    #quiz-container {
      font-size: 50px;
      margin-top: 10px;
      text-align: center;
    }
    
    .hidden-character {
      position: relative;
      display: inline-block;
      width: 100px;
      height: 100px;
      border: 1px solid black;
      background-color: red;
      color: #fff;
      line-height: 100px;
      text-align: center;
      z-index: 1;
    }
    
    .visible-character {
      display: inline-block;
      width: 100px;
      height: 100px;
      border: 1px solid black;
      background-color: #EEE;
      color: #000;
      line-height: 100px;
      text-align: center;
    }
    
    .hidden-character:before {
      content: attr(data-index);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2;
      background-color: rgb(255, 0, 0);
    }
    
    #quiz-text {
      font-size: 50px;
      margin-bottom: 10px;
      white-space: nowrap;
    }

    #quiz-text span:nth-child(6n)::after {
      content: "";
      display: block;
    }
    
    #answer-input {
      font-size: 36px;
      padding: 5px;
      margin-bottom: 10px;
      text-align: center;
    }
    
    #result-section {
      font-size: 60px;
      padding: 5px;
      margin-bottom: 10px;
      text-align: center;
    }
    #submit-button {
      font-size: 36px;
      padding: 5px 10px;
      text-align: center;
    }

    #tweet-section {
      display: none;
      text-align: center;
    }

    .tweet-button {
      display: inline-block;
      padding: 10px 20px;
      font-size: 36px;
      background-color: #007bff;
      color: #fff;
      border: none;
      text-decoration: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div>
    <h1 id="quiz-container">Yokodo</h1>
    <p id="quiz-lore">éš ã‚Œã¦ã„ã‚‹å•é¡Œæ–‡ã€‚<br>ã‚ãªãŸã¯æ•°å­—ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å•é¡Œæ–‡ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚<br>ãªã‚‹ã¹ãã‚¯ãƒªãƒƒã‚¯ã›ãšã«å•é¡Œã®ç­”ãˆã‚’å½“ã¦ã¾ã—ã‚‡ã†ã€‚<br>å›ç­”ã¯ä½•å›ã§ã‚‚ã§ãã¾ã™ã€‚</p>
    <div id="score-section"></div>
    <div id="quiz-text"></div>
    <div id="answer-section">
      <input type="text" id="answer-input" placeholder="å›ç­”ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„" onkeydown="handleKeyDown(event)">
      <button id="submit-button" onclick="checkAnswer()">å›ç­”ã™ã‚‹</button>
    </div>
    <div id="result-section"></div>
    <div id="tweet-section">
      <a id="tweet-link" class="tweet-button" href="https://twitter.com/intent/tweet" target="_blank">ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹</a>
    </div>
  </div>

  <script>
    // ã‚¯ã‚¤ã‚ºã®æ–‡ã®ãƒªã‚¹ãƒˆ
    class quiz {
        0 = [ { q: "CO2ã¨ã„ã†æ°—ä½“ã¯æ¼¢å­—5æ–‡å­—ã§ä½•ã¨æ›¸ãï¼Ÿ" , a: "äºŒé…¸åŒ–ç‚­ç´ "} ];
        1 = [ { q: "å¤ªé™½ç³»ã«ã‚ã‚‹å”¯ä¸€ã®æ’æ˜Ÿã‚’ä¸€èˆ¬çš„ã«æ¼¢å­—2æ–‡å­—ã§ä½•ã¨å‘¼ã¶ï¼Ÿ" , a: "å¤ªé™½"} ]
        2 = [ { q: "1600å¹´ã®å¾³å·å®¶åº·ã¨çŸ³ç”°ä¸‰æˆã®æˆ¦ã„ã‚’ä¸€èˆ¬çš„ã«ã€‡ã€‡ã€‡ã®æˆ¦ã„ã¨å‘¼ã¶ãŒã€‡ã€‡ã€‡ã«å…¥ã‚‹æ¼¢å­—3æ–‡å­—ã‚’æ›¸ã‘" , a: "é–¢ãƒ¶åŸ"} ]
        3 = [ { q: "æ¤ç‰©ãŒæ „é¤Šã‚’å…‰ã‹ã‚‰ä½œã‚Šå‡ºã™ã“ã¨ã‚’æ¼¢å­—3æ–‡å­—ã§ä½•ã¨æ›¸ãï¼Ÿ" , a: "å…‰åˆæˆ"} ]

        // ä»–ã®ã‚¯ã‚¤ã‚ºã®æ–‡ã‚’è¿½åŠ 
    }
    const quizList = new quiz()
    // ãƒ©ãƒ³ãƒ€ãƒ ãªå•é¡Œæ–‡ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—
    let randomIndex = Math.floor(Math.random() * Object.keys(quizList).length);
    console.log(randomIndex)
    // é¸æŠã•ã‚ŒãŸå•é¡Œæ–‡
    let selectedQuiz = quizList[randomIndex][0].q
    console.log(selectedQuiz)
    
    // å•é¡Œæ–‡ã®æ–‡å­—æ•°
    let quizLength = selectedQuiz.length;
    let totalCharactersPressed = quizLength
    // åˆæœŸåŒ–
    let hiddenCharacters = quizLength;
    let quizTextElement = document.getElementById("quiz-text");
    let answerInputElement = document.getElementById("answer-input");
    let resultSectionElement = document.getElementById("result-section");
    let tweetSectionElement = document.getElementById("tweet-section");
    let scoreSectionElement = document.getElementById("score-section");
    let tweetLinkElement = document.getElementById("tweet-link");
    scoreSectionElement.textContent = totalCharactersPressed + "/" + quizLength
    // å•é¡Œæ–‡ã®å„æ–‡å­—ã‚’â–¡ã§è¡¨ç¤º
    let result = []
    for (let i = 0; i < quizLength; i++) {
      result[result.length] = "ğŸŸ¥"
      let hiddenCharacter = document.createElement("span");
      hiddenCharacter.classList.add("hidden-character");
      hiddenCharacter.setAttribute("data-index", i + 1);
      hiddenCharacter.textContent = selectedQuiz.split(``)[i];
      quizTextElement.appendChild(hiddenCharacter);

      if ((i + 1) % 6 === 0) {
        quizTextElement.appendChild(document.createElement("br"));
      }
    }

    // â–¡ã‚’æŠ¼ã™ã“ã¨ã§æ–‡å­—ã‚’è¡¨ç¤º
    quizTextElement.addEventListener("click", function(event) {
      if (event.target.classList.contains("hidden-character")) {
        event.target.classList.remove("hidden-character");
        event.target.classList.add("visible-character");
        let characterIndex = event.target.getAttribute("data-index");
        result.slice(Number(characterIndex) - 1,1)
        result[Number(characterIndex)-1] = "â¬œ"
        hiddenCharacters--;
        totalCharactersPressed--;
        scoreSectionElement.textContent = totalCharactersPressed + "/" + quizLength
      }
    });

    // å›ç­”ã®ãƒã‚§ãƒƒã‚¯
    function handleKeyDown(event) {
        if (event.key === "Enter") {
            event.preventDefault(); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã®æŒ™å‹•ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«        
            // ã“ã“ã«ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ãŒæŠ¼ã•ã‚ŒãŸæ™‚ã®å‡¦ç†ã‚’è¨˜è¿°ã™ã‚‹
            checkAnswer();
        }
    }

    function checkAnswer() {
      let userAnswer = answerInputElement.value.trim();

      // å›ç­”ãŒæ­£è§£ã‹ã©ã†ã‹ãƒã‚§ãƒƒã‚¯
      if (userAnswer === quizList[randomIndex][0].a) {
        resultSectionElement.textContent = "æ­£è§£ï¼";
        answerInputElement.disabled = true;
        document.getElementById("submit-button").disabled = true;
        let hiddenCharactersElements = document.getElementsByClassName("hidden-character");
        while (hiddenCharactersElements.length > 0) {
          hiddenCharactersElements[0].classList.add("visible-character");
          hiddenCharactersElements[0].classList.remove("hidden-character");
        }

        // æ­£è§£ã—ãŸå ´åˆã€ãƒ„ã‚¤ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
        tweetSectionElement.style.display = "block";
      } else {
        resultSectionElement.textContent = "ä¸æ­£è§£ï¼";
        answerInputElement.value = "";
      }

      // ãƒ„ã‚¤ãƒ¼ãƒˆå†…å®¹ã®ä½œæˆ
      for (let i = 0; i < result.length; i++) {
        if (i % 6 === 0 && i !== 0) {
            result[i] = "\n" + result[i]
        }
      }
      console.log(result)
      let tweetText = "ã‚¹ã‚³ã‚¢ï¼š" + totalCharactersPressed + "/" + quizLength + "\n\n" + result.join(``) + "\n\n#Yokodo";

      // ãƒ„ã‚¤ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã®ãƒªãƒ³ã‚¯å…ˆã‚’è¨­å®š
      tweetLinkElement.href = "https://twitter.com/intent/tweet?text=" + encodeURIComponent(tweetText);
    }
  </script>
</body>
</html>
